---
phase: 13-enhanced-progress-ui
plan: 02
type: execute
---

<objective>
Add aggregate progress indicators and time estimates for queue/epic commands.

Purpose: When running multiple stories, users need visibility into overall progress and estimated completion time.
Output: Queue and epic commands show story-level progress and time estimates based on completed story durations.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan in this phase:

@.planning/phases/13-enhanced-progress-ui/13-01-SUMMARY.md

# Key source files:

@internal/cli/queue.go
@internal/cli/epic.go
@internal/output/printer.go

**Tech stack available:** Go, Cobra, Lipgloss
**Established patterns:** Printer interface, QueueStoryStart method exists
**Constraining decisions:** Plan 13-01 adds step-level progress; this plan adds story-level progress
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add queue/epic progress output</name>
  <files>internal/cli/queue.go, internal/cli/epic.go</files>
  <action>
Update queue and epic commands to show story-level progress during execution:

1. Before each story execution, print progress header:
   - Format: "Story [2/5] 6-2-schema"
   - Use existing Printer.QueueStoryStart(index, total, storyKey) which already exists

2. Calculate total steps across all stories (using GetSteps for each) at start
3. Track cumulative step count as stories complete
4. Before each story, show aggregate progress:
   - Format: "[Story 2/5 | ~8 steps remaining]"

The existing QueueStoryStart already provides "QUEUE [2/5]: story-key" format - enhance or add a companion method for the aggregate view.

Apply same pattern to both queue.go and epic.go (they share similar structure).
</action>
<verify>go build ./... succeeds; manual test with `./bmad-automate queue --dry-run 6-1 6-2` shows progress format</verify>
<done>Queue and epic commands show story progress with remaining step estimates before each story</done>
</task>

<task type="auto">
  <name>Task 2: Add duration tracking and time estimates</name>
  <files>internal/cli/queue.go, internal/cli/epic.go</files>
  <action>
Add time estimation based on completed story durations:

1. Track start time and duration for each completed story
2. After first story completes, calculate average duration per story
3. Display estimated time remaining before each subsequent story:
   - Format: "Story [2/5] 6-2-schema (est. ~3m remaining)"
   - Only show estimate after at least 1 story completed (need data)

4. At completion, show total duration and average per story in summary:
   - "Completed 5 stories in 12m 34s (avg 2m 30s/story)"

Implementation approach:

- Create a simple struct to track: startTime, durations []time.Duration
- Calculate: avgDuration = sum(durations) / len(durations)
- Estimate remaining: avgDuration \* remainingStories

Apply to both queue and epic commands.
</action>
<verify>go build ./... succeeds; `go test ./...` passes</verify>
<done>Queue and epic show time estimates after first story, final summary shows average duration</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build ./...` succeeds without errors
- [ ] `go test ./...` passes (no regressions)
- [ ] Manual test: queue/epic commands show story progress
- [ ] Manual test: time estimates appear after first story completes
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors introduced
- Queue and epic commands show story progress and time estimates
- Phase 13 complete
  </success_criteria>

<output>
After completion, create `.planning/phases/13-enhanced-progress-ui/13-02-SUMMARY.md`
</output>
